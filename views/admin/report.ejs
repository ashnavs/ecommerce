
<head>
    <!-- Include Slick Slider CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>

    <!-- Include Slick Slider theme CSS (optional) -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>
</head>


<%- include('../partials/adminHeader') %>
<%- include('../partials/adminSidebar') %>

<style>
    .btn {
        border: 1px solid #ccc; /* Set border color */
        padding: 5px 10px; /* Adjust padding for better appearance */
        margin-right: 5px; /* Adjust margin for spacing between buttons */
        text-decoration: none; /* Remove default underline */
        color: #333; /* Set text color */
    }

    .btn.active {
        border-color: #007bff; /* Set active button border color */
        background-color: #007bff; /* Set active button background color */
        color: #fff; /* Set active button text color */
    }
</style>


            <!-- Reports Section Start -->
            <div class="page-body">
                <!-- Container-fluid starts-->
                <div class="container-fluid">
                    <div class="row">
                        <!-- Salery Summy star-->
                        <!-- <div class="col-xl-8 col-lg-12 col-md-6">
                            <div class="card o-hidden">
                                <div class="card-header border-0 pb-1">
                                    <div class="card-header-title">
                                        <h4>Sales Summary</h4>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div id="saler-summary"></div>
                                </div>
                            </div>
                        </div> -->
                        <!-- Salery Summy end-->

                        <!-- Employ Salary  start-->
                        <!-- <div class="col-xl-4 col-lg-12 col-md-6">
                            <div class="h-100">
                                <div class="card o-hidden">
                                    <div class="card-header border-0 pb-1">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="card-header-title">
                                                <h4>Employees Satisfied</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <div class="pie-chart">
                                            <div id="employ-salary"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <!-- Employ Salary end-->

                        <!-- Expenses star-->
                        <!-- <div class="col-xl-4 col-lg-12 col-md-6">
                            <div class="card o-hidden">
                                <div class="card-header border-0 pb-1">
                                    <div class="card-header-title">
                                        <h4>Expenses</h4>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div id="expenses-cart"></div>
                                </div>
                            </div>
                        </div> -->
                        <!-- Expenses end-->

                        <!-- Sales / Purchase chart start -->
                        <!-- <div class="col-xl-8 col-lg-12 col-md-6">
                            <div class="card">
                                <div class="card-header border-0 pb-1">
                                    <div class="card-header-title">
                                        <h4>Sales / Purchase</h4>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div id="sales-purchase-chart"></div>
                                </div>
                            </div>
                        </div> -->
                        <!-- Sales / Purchase chart end -->

                        <!-- Sales / Purchase Return star-->
                        <!-- <div class="col-12">
                            <div class="card o-hidden">
                                <div class="card-header border-0 pb-1">
                                    <div class="card-header-title">
                                        <h4>Sales / Purchase Return</h4>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <div id="sales-purchase-return-cart"></div>
                                </div>
                            </div>
                        </div> -->
                        <!-- Sales / Purchase Return end-->

                        <!-- Booking history start-->
                        <div class="row d-flex">
                        <div class="col-12">
                            <div class="card" style="
                            display: flex;
                            flex-direction: row;
                            justify-content: space-between;
                            align-items: center;
                        ">

                        <!-- Add the selected status as a class to highlight the active filter -->
                        <div style="display: flex;">
                            <a href="/admin/report?report=Daily" class="btn btn-sm rounded ">Daily</a>
                            <a href="/admin/report?report=Monthly" class="btn btn-sm rounded">Weekly</a>
                            <a href="/admin/report?report=Yearly" class="btn btn-sm rounded ">Yearly</a>
                        </div>
                        
                        
                        



                                  <div class="row d-flex">
                                    <div class="col-md-12 text-right" style="
                                    display: flex;">
                                            <button id="downloadPdf" class="btn btn-secondary print ms-2" style="color: white;"><i class="icon material-icons md-print" ></i> Download PDF</button>
                                            <!-- <a href="/admin/excelsalesreport" class="btn btn-secondary print ms-2" style="width: fit-content; color: white;"><i class="icon material-icons md-print" ></i>Download Excel</a> -->
                
                                 </div>
                                </div>
                
                                <form action="" method="get" >
                                    <label for="paymentMethod" class="form-label" >Select Status:</label>
                                <div class="col-md-3 col-12 me-auto mb-md-0 mb-3" style="display: flex;"> 
                
                                    
                                <select name="paymentMethod" class="form-select" style="height: 36px;width: 168px;" id="paymentMethod">
                                        
                                        <option value="" selected>All</option>
                                        <option value="Online Payment">RazorPay</option>
                                        <option value="Cash On Delivery">Cash On Delivery</option>
                                       
                
                
                                    </select>
                                  
                                  <input type="submit" class="btn btn-md rounded font-sm ms-2" value="Filter">
                                </div>
                                </div>
                                <p>Total Revenue: <%=totalRevenue %></p>
                                
                                <p>Total Sales: <%= totalSales%></p>
                                <p>Total Product Sold: <%= totalProductsSold%></p>
                                <div>
                
                                </div>
                                <!-- <a href="/admin/download-pdf" class="btn btn-primary">Download PDF</a> -->

                                <div class="card-header border-0 pb-1">
                                    <div class="card-header-title">
                                        <h3>Transfer History</h3>
                                    </div>
                                </div>

                                <div class="card-body">
                                    <div >
                                        <div class="table-responsive">
                                            <table class="user-table list-table table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Order Id</th>
                                                        <th>Buyer</th>
                                                        <th>Product Name</th>
                                                        <th>Category</th>
                                                        <th>Status</th>
                                                      
                                                        <th>Quantity</th>
                                                        <th>Total</th>
                                                        <th>Payment Method</th>

                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% orders.forEach(order => { %>
                                                        <% order.products.forEach(product => { %>
                                                            <tr>
                                                                <td><%= order.createdAt.toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' }) %></td>
                                                                <td><%= order.order_Id %></td>
                                                                <td><%= order.user.name %></td>
                                                                <td><%= product.product ? product.product.name : 'N/A' %></td>
                                                                <td><%= product.product && product.product.category ? product.product.category.name : 'N/A' %></td>
                                                                <td><%= order.status%></td>
                                                                <td><%= product.quantity %></td>
                                                                <td><%= product.total %></td>
                                                                <td><%= order.paymentMethod %></td>
                                                              
                                                            </tr>
                                                        <% }); %>
                                                    <% }); %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    
                        <!-- Booking history  end-->
                    </div>
                </div>
                <!-- Container-fluid Ends-->

                <!-- footer start-->
                <div class="container-fluid">
                    <footer class="footer">
                        <div class="row">
                            <div class="col-md-12 footer-copyright text-center">
                                <p class="mb-0">Copyright 2023 Â© Lapkart</p>
                            </div>
                        </div>
                    </footer>
                </div>
            </div>
            <!-- Reports Section End -->
        </div>
        <!-- Page Body End-->
    </div>
    <!-- page-wrapper End-->

    <!-- Modal Start -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body">
                    <h5 class="modal-title" id="staticBackdropLabel">Logging Out</h5>
                    <p>Are you sure you want to log out?</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <div class="button-box">
                        <button type="button" class="btn btn--no" data-bs-dismiss="modal">No</button>
                        <button type="button" class="btn  btn--yes btn-primary">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal End -->
    


    <!-- latest js -->
    <script src="/assetsb/js/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap js -->
    <script src="/assetsb/js/bootstrap/bootstrap.bundle.min.js"></script>

    <!-- feather icon js -->
    <script src="/assetsb/js/icons/feather-icon/feather.min.js"></script>
    <script src="/assetsb/js/icons/feather-icon/feather-icon.js"></script>

    <!-- scrollbar simplebar js -->
    <script src="/assetsb/js/scrollbar/simplebar.js"></script>
    <script src="/assetsb/js/scrollbar/custom.js"></script>

    <!-- Sidebar js -->
    <script src="/assetsb/js/config.js"></script>

    <!-- tooltip init js -->
    <script src="/assetsb/js/tooltip-init.js"></script>

    <!-- Plugins js -->
    <script src="/assetsb/js/sidebar-menu.js"></script>
    <script src="/assetsb/js/notify/bootstrap-notify.min.js"></script>
    <script src="/assetsb/js/notify/index.js"></script>

    <!-- Apexchar js -->
    <script src="/assetsb/js/chart/apex-chart/apex-chart1.js"></script>
    <script src="/assetsb/js/chart/apex-chart/moment.min.js"></script>
    <script src="/assetsb/js/chart/apex-chart/apex-chart.js"></script>
    <script src="/assetsb/js/chart/apex-chart/stock-prices.js"></script>
    <script src="/assetsb/js/chart/apex-chart/chart-custom.js"></script>

    <!-- customizer js -->
    <script src="/assetsb/js/customizer.js"></script>

    <!-- ratio js -->
    <script src="/assetsb/js/ratio.js"></script>

    <!-- sidebar effect -->
    <script src="/assetsb/js/sidebareffect.js"></script>

    <!-- Theme js -->
    <script src="/assetsb/js/script.js"></script>

    <!--PDF-->
    <script>
        document.getElementById('downloadPdf').addEventListener('click', function () {
            const selectedValue = document.getElementById('paymentMethod').value;
            const url = `/admin/report?report=<%= reportOrder %>&paymentMethod=${selectedValue}&downloadPdf=true`;
            window.location.href = url;
        });
    
        document.getElementById('downloadExcel').addEventListener('click', function () {
            const selectedValue = document.getElementById('paymentMethod').value;
            const url = `/admin/download-excel?paymentMethod=${selectedValue}`;
            window.location.href = url;
        });
    </script>
    
</body>


<!-- Mirrored from themes.pixelstrap.com/fastkart/back-end/reports.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 04 Sep 2023 05:49:49 GMT -->
</html>